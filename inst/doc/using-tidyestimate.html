<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Kai Aragaki" />

<meta name="date" content="2021-09-09" />

<title>Using tidyestimate</title>

<script src="data:application/javascript;base64,Ly8gUGFuZG9jIDIuOSBhZGRzIGF0dHJpYnV0ZXMgb24gYm90aCBoZWFkZXIgYW5kIGRpdi4gV2UgcmVtb3ZlIHRoZSBmb3JtZXIgKHRvCi8vIGJlIGNvbXBhdGlibGUgd2l0aCB0aGUgYmVoYXZpb3Igb2YgUGFuZG9jIDwgMi44KS4KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKGUpIHsKICB2YXIgaHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCJkaXYuc2VjdGlvbltjbGFzcyo9J2xldmVsJ10gPiA6Zmlyc3QtY2hpbGQiKTsKICB2YXIgaSwgaCwgYTsKICBmb3IgKGkgPSAwOyBpIDwgaHMubGVuZ3RoOyBpKyspIHsKICAgIGggPSBoc1tpXTsKICAgIGlmICghL15oWzEtNl0kL2kudGVzdChoLnRhZ05hbWUpKSBjb250aW51ZTsgIC8vIGl0IHNob3VsZCBiZSBhIGhlYWRlciBoMS1oNgogICAgYSA9IGguYXR0cmlidXRlczsKICAgIHdoaWxlIChhLmxlbmd0aCA+IDApIGgucmVtb3ZlQXR0cmlidXRlKGFbMF0ubmFtZSk7CiAgfQp9KTsK"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="data:text/css,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">Using tidyestimate</h1>
<h4 class="author">Kai Aragaki</h4>
<h4 class="date">2021-09-09</h4>



<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyestimate)</span></code></pre></div>
<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p><code>tidyestimate</code> is a tidy implementation of the <code>estimate</code> package and paper (Yoshihara et al. 2013).</p>
<p><code>estimate</code> infers tumor purity from gene expression data by performing gene-set-enrichment-analysis (GSEA)(Subramanian et al. 2005) on a single-sample basis (ssGSEA)(Barbie et al. 2009), using both a stromal and immune gene set. By adding these two signatures together, an ESTIMATE score can then be converted into an inferred purity score.</p>
<p>Whereas <code>estimate</code> inputs and outputs were largely <code>.GCT</code> files, <code>tidyestimate</code> simplifies the <code>estimate</code> package by taking a data frame, tibble, or matrix as an input, and returning a tibble. This eliminates the need for intermediate files, reduces execution time, and allows for tidier (pipe-compatible) code. Furthermore, <code>tidyestimate</code> provides an optional conservative alias-matching algorithm to capture genes that may be listed under a different name within the dataset.</p>
</div>
<div id="use" class="section level1">
<h1>Use</h1>
<p>The dataset we will be using is a set of 10 ovarian cancer tumors, whose expression was profiled using Affymetrix arrays</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(ov)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 17256    10</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(ov[, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>])</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             s516    s518    s519    s520    s521</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; C9orf152  4.8815  4.5757  3.7395  3.6960  4.1597</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ELMO2     7.2981  7.5554  7.5332  7.3824  7.3079</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; CREB3L1   5.5692  5.7004  5.9597  5.7700  5.2190</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; RPS11    13.3899 13.8488 13.6429 13.6546 13.5698</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; PNMA1     9.3480 10.0092 10.4310  9.5399  9.6423</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; MMP2      7.6182  8.0369  8.9551 10.3875  7.4141</span></span></code></pre></div>
<p>This dataset is a matrix, but it could just as easily be a <code>tibble</code> or <code>data.frame</code>. The identifiers can either be HGNC symbols or Entrez IDs - here we have HGNC symbols.</p>
<p>The ESTIMATE algorithm is sensitive to number of genes included. As such, we will filter for genes that are common to six different expression profiling platforms (see <code>?tidyestimate::common_genes</code> for more information).</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>filtered <span class="ot">&lt;-</span> <span class="fu">filter_common_genes</span>(ov, </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>                                <span class="at">id =</span> <span class="st">&quot;hgnc_symbol&quot;</span>, </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>                                <span class="at">tidy =</span> <span class="cn">FALSE</span>, </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>                                <span class="at">tell_missing =</span> <span class="cn">TRUE</span>, </span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>                                <span class="at">find_alias =</span> <span class="cn">TRUE</span>)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 461 of 488 missing genes found matches using aliases.</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The following genes are in the list of common genes, but not in your dataset:</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ACKR2 EPRS1 AOC1 GARS1 ASIC2 MELTF SEPTIN2 SEPTIN4 POLR1G B4GAT1...and 17 others</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Found 10364 of 10391 genes (99.74%) in your dataset.</span></span></code></pre></div>
<p>You will notice there are several arguments:</p>
<ul>
<li><p>The first is the dataset (this allows for piping, if need be - as is the case for all functions in <code>tidyestimate</code>).</p></li>
<li><p><code>id</code> specifies the type of gene ID. As mentioned, it can either be an HGNC symbol (<code>&quot;hgnc_symbol&quot;</code>) or an Entrez ID (<code>&quot;entrezgene_id&quot;</code>).</p></li>
<li><p>The <code>tidy</code> argument allows you to specify if the IDs are rownames, or if they are in the first column of the provided input. Set <code>tidy = TRUE</code> if identifiers are in the first column of the data, and <code>FALSE</code> if they are encoded in the rownames. This option for an input of a tibble, which does not allow for rownames. It lacks a default value to ensure the operator is aware of the decision they are making, lest one sample be mistaken for names or vice-versa.</p></li>
<li><p>The <code>tell_missing</code> argument determines whether a message should be emitted about genes that failed to find a match in the dataset.</p></li>
<li><p>The <code>find_alias</code> argument determine whether, upon failing to find some of the common genes in your dataset, it should see if they are listed under an alias. The method used is quite conservative: it will only assume a match is a match if there is a one-to-one match between one gene name and one alias in the provided dataset.</p></li>
</ul>
<p>After we have put our dataset on common ground, we can calculate the ESTIMATE score for each sample:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>scored <span class="ot">&lt;-</span> <span class="fu">estimate_score</span>(filtered,</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>                         <span class="at">is_affymetrix =</span> <span class="cn">TRUE</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of stromal_signature genes in data: 141 (out of 141)</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of immune_signature genes in data: 141 (out of 141)</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>scored</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    sample    stromal     immune   estimate    purity</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1    s516 -285.49841  165.75062  -119.7478 0.8323791</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2    s518 -429.16931   99.71302  -329.4563 0.8490421</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3    s519  -60.98619 -368.70314  -429.6893 0.8567232</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4    s520 1927.51431 2326.15984  4253.6742 0.3348246</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5    s521 -673.84954  141.72775  -532.1218 0.8643812</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6    s522 1447.95517 1166.51854  2614.4737 0.5497248</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 7    s523 -271.15756 -928.44921 -1199.6068 0.9094242</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 8    s525  965.61804 1310.27775  2275.8958 0.5905450</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 9    s526  545.99467 2149.10473  2695.0994 0.5398002</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10   s527 -710.44370 1303.08009   592.6364 0.7699846</span></span></code></pre></div>
<p>Note that the <code>estimate_score</code> function takes an <code>is_affymetrix</code> argument. This argument determines whether or not a purity score will be calculated for the samples. As the data used to train the model to convert ESTIMATE scores to purity scores were produced by Affymetrix, it is unwise to infer a tumor purity score using the same method for RNAseq data. However, stromal and immune infiltration as well as ESTIMATE scores can be used to measure relative purity in RNAseq samples (versus absolute 0 to 1 purity inferred for Affymetrix samples). For instance, sample <code>s516</code> has less stroma than it does immune cell infiltrate. Further, it has more stromal infiltration than sample <code>s518</code>. By looking at the ESTIMATE scores, we can see that <code>s516</code> is less pure than <code>s518</code>. This can be said absolutely with the purity values: <code>s516</code> is roughly 83% pure, a metric that can be used both within and across studies.</p>
<p>In the case of Affymetrix samples, where a purity score can be calculated, you may want to see where your sample stands in the model generated by Yoshihara et al. This can be done simply with plotting:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_purity</span>(scored, <span class="at">is_affymetrix =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The <code>is_affymetrix</code> argument is a bit of a false choice - if <code>FALSE</code>, the function will remind the user that purity scores for non-Affymetrix data are not supported, then stop.</p>
<p>On this plot, gray circles represent the Affymetrix samples used to train the model. Their tumor purity was measured using the ABSOLUTE method (Carter et al. 2012), and a model was fit using an evolutionary model that takes the form of</p>
<p><span class="math display">\[\cos(0.6049872018 + 0.0001467884 * ESTIMATE)\]</span></p>
<p>The red circles, then, represent the input samples, and have been labeled by their sample name (column names in the original matrix)</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
